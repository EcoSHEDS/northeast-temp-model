<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Theory | EcoSHEDS Northeast Stream Temperature Model</title>
  <meta name="description" content="Documentation for the EcoSHEDS Northeast Stream Temperature Model." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Theory | EcoSHEDS Northeast Stream Temperature Model" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the EcoSHEDS Northeast Stream Temperature Model." />
  <meta name="github-repo" content="ecosheds/northeast-temp-model" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Theory | EcoSHEDS Northeast Stream Temperature Model" />
  
  <meta name="twitter:description" content="Documentation for the EcoSHEDS Northeast Stream Temperature Model." />
  

<meta name="author" content="Developed and maintained by Jeff Walker and Ben Letcher as part of the USGS EcoSHEDS project. Initial model developed by Dan Hocking." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="data-sources.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CBK3R7N2WQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-CBK3R7N2WQ');
</script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Northeast Stream Temperature Model</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#model-overview"><i class="fa fa-check"></i><b>1.1</b> Model Overview</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#current-snapshot"><i class="fa fa-check"></i><b>1.2</b> Current Snapshot</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#model-versioning"><i class="fa fa-check"></i><b>1.3</b> Model Versioning</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#source-code"><i class="fa fa-check"></i><b>1.4</b> Source Code</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#change-log"><i class="fa fa-check"></i><b>1.5</b> Change Log</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>2</b> Theory</a>
<ul>
<li class="chapter" data-level="2.1" data-path="theory.html"><a href="theory.html#fixed-effects"><i class="fa fa-check"></i><b>2.1</b> Fixed Effects</a></li>
<li class="chapter" data-level="2.2" data-path="theory.html"><a href="theory.html#catchment-random-effects"><i class="fa fa-check"></i><b>2.2</b> Catchment Random Effects</a></li>
<li class="chapter" data-level="2.3" data-path="theory.html"><a href="theory.html#huc-random-effects"><i class="fa fa-check"></i><b>2.3</b> HUC Random Effects</a></li>
<li class="chapter" data-level="2.4" data-path="theory.html"><a href="theory.html#year-random-effects"><i class="fa fa-check"></i><b>2.4</b> Year Random Effects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>3</b> Data Sources</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-sources.html"><a href="data-sources.html#covariate-datasets"><i class="fa fa-check"></i><b>3.1</b> Covariate Datasets</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-sources.html"><a href="data-sources.html#catchment-delineation"><i class="fa fa-check"></i><b>3.1.1</b> Catchment Delineation</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-sources.html"><a href="data-sources.html#climate-data"><i class="fa fa-check"></i><b>3.1.2</b> Climate Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-sources.html"><a href="data-sources.html#geospatial-characteristics"><i class="fa fa-check"></i><b>3.1.3</b> Geospatial Characteristics</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-sources.html"><a href="data-sources.html#stream-temperature-observations"><i class="fa fa-check"></i><b>3.2</b> Stream Temperature Observations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-sources.html"><a href="data-sources.html#data-summary"><i class="fa fa-check"></i><b>3.2.1</b> Data Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-processing.html"><a href="data-processing.html"><i class="fa fa-check"></i><b>4</b> Data Processing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-processing.html"><a href="data-processing.html#screen-monitoring-stations"><i class="fa fa-check"></i><b>4.1</b> Screen Monitoring Stations</a></li>
<li class="chapter" data-level="4.2" data-path="data-processing.html"><a href="data-processing.html#screen-daily-mean-values"><i class="fa fa-check"></i><b>4.2</b> Screen Daily Mean Values</a></li>
<li class="chapter" data-level="4.3" data-path="data-processing.html"><a href="data-processing.html#combine-overlapping-timeseries"><i class="fa fa-check"></i><b>4.3</b> Combine Overlapping Timeseries</a></li>
<li class="chapter" data-level="4.4" data-path="data-processing.html"><a href="data-processing.html#screen-multiple-locations-within-single-catchment"><i class="fa fa-check"></i><b>4.4</b> Screen Multiple Locations within Single Catchment</a></li>
<li class="chapter" data-level="4.5" data-path="data-processing.html"><a href="data-processing.html#remove-cold-weather-periods"><i class="fa fa-check"></i><b>4.5</b> Remove Cold Weather Periods</a></li>
<li class="chapter" data-level="4.6" data-path="data-processing.html"><a href="data-processing.html#split-dataset-for-calibration-and-validation"><i class="fa fa-check"></i><b>4.6</b> Split Dataset for Calibration and Validation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html"><i class="fa fa-check"></i><b>5</b> Calibration and Validation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#parameter-estimates"><i class="fa fa-check"></i><b>5.1</b> Parameter Estimates</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#fixed-effects-1"><i class="fa fa-check"></i><b>5.1.1</b> Fixed Effects</a></li>
<li class="chapter" data-level="5.1.2" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#huc8-random-effects"><i class="fa fa-check"></i><b>5.1.2</b> HUC8 Random Effects</a></li>
<li class="chapter" data-level="5.1.3" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#catchment-random-effects-1"><i class="fa fa-check"></i><b>5.1.3</b> Catchment Random Effects</a></li>
<li class="chapter" data-level="5.1.4" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#year-random-effects-1"><i class="fa fa-check"></i><b>5.1.4</b> Year Random Effects</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#goodness-of-fit"><i class="fa fa-check"></i><b>5.2</b> Goodness-of-Fit</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="predictions.html"><a href="predictions.html"><i class="fa fa-check"></i><b>6</b> Predictions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="predictions.html"><a href="predictions.html#air-temperature-scenarios"><i class="fa fa-check"></i><b>6.1</b> Air Temperature Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="download.html"><a href="download.html"><i class="fa fa-check"></i><b>7</b> Download</a>
<ul>
<li class="chapter" data-level="7.1" data-path="download.html"><a href="download.html#stream-temperature-model-predictions-dataset"><i class="fa fa-check"></i><b>7.1</b> Stream Temperature Model Predictions Dataset</a></li>
<li class="chapter" data-level="7.2" data-path="download.html"><a href="download.html#catchment-delineation-shapefiles"><i class="fa fa-check"></i><b>7.2</b> Catchment Delineation Shapefiles</a></li>
<li class="chapter" data-level="7.3" data-path="download.html"><a href="download.html#catchment-covariates-dataset"><i class="fa fa-check"></i><b>7.3</b> Catchment Covariates Dataset</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EcoSHEDS Northeast Stream Temperature Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="theory" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Section 2</span> Theory<a href="theory.html#theory" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The stream temperature model is a nested hierarchical Bayesian model that predicts daily stream temperature based on catchment characteristics and climate conditions. An early version of this model can be found in <span class="citation">Letcher et al. (<a href="#ref-Letcher2016">2016</a>)</span>.</p>
<p>Daily mean stream temperature for each catchment is assumed to be a normally distributed random variable:</p>
<p><span class="math display">\[t_{h,c,y,d} \sim \mathcal{N}(\mu_{h,c,y,d},\sigma_{[t]})\]</span></p>
<p>where <span class="math inline">\(t_{h,c,y,d}\)</span> is the mean stream temperature on day <span class="math inline">\(d\)</span> within year <span class="math inline">\(y\)</span> for catchment <span class="math inline">\(c\)</span>, which is located within HUC8 <span class="math inline">\(h\)</span>. This random variable is normally distributed with an expected mean <span class="math inline">\(\mu_{h,c,y,d}\)</span> and standard deviation <span class="math inline">\(\sigma_{[t]}\)</span>.</p>
<p>The expected mean is computed as:</p>
<p><span class="math display">\[
\mu_{h,c,y,d} = \left \{
  \begin{array}{l l}
    \omega_{h,c,y,d} + \delta_{h}(t_{h,c,y,d-1} - \omega_{h,c,y,d-1}) &amp; \quad \text{for } t_{h,c,y,d-1} \text{ is real} \\
    \omega_{h,c,y,d} &amp; \quad \text{for } t_{h,c,y,d-1} \text{ is not real}
  \end{array} \right.
\]</span></p>
<p>where <span class="math inline">\(\delta_h\)</span> is an autoregressive [AR(1)] coefficient and <span class="math inline">\(\omega_{h,c,y,d}\)</span> is the expected temperature before accounting for temporal autocorrelation in the error structure.</p>
<p>The expected temperature is computed as a linear equation with four sets of terms:</p>
<p><span class="math display">\[\omega_{h,c,y,d} = X_{[0]} B_{[0]} + X_{h,c} B_{h,c} + X_{h} B_{h} + X_{y} B_{y}\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(B_{[0]}\)</span> is a vector of fixed effect coefficients</li>
<li><span class="math inline">\(B_{h,c}\)</span> is a vector of random effect coefficients for catchment <span class="math inline">\(c\)</span></li>
<li><span class="math inline">\(B_{h}\)</span> is a vector of random effect coefficients for HUC <span class="math inline">\(h\)</span></li>
<li><span class="math inline">\(B_{y}\)</span> is a vector of random effect coefficients for year <span class="math inline">\(y\)</span></li>
</ul>
<p>Each of these vectors is multiplied by a corresponding matrix containing the corresponding predictor values (<span class="math inline">\(X\)</span>) of each catchment <span class="math inline">\(c\)</span> (located within HUC <span class="math inline">\(h\)</span>) and on each day <span class="math inline">\(d\)</span> (within year <span class="math inline">\(y\)</span>).</p>
<div id="fixed-effects" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Fixed Effects<a href="theory.html#fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The fixed effects are shared among all catchments within the model domain. They include the following terms:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intercept</code></td>
<td align="left">Intercept</td>
</tr>
<tr class="even">
<td align="left"><code>AreaSqKM</code></td>
<td align="left">Total Drainage Area (km2)</td>
</tr>
<tr class="odd">
<td align="left"><code>impoundArea</code></td>
<td align="left">Impounded Drainage Area (km2)</td>
</tr>
<tr class="even">
<td align="left"><code>agriculture</code></td>
<td align="left">Agricultural Land Cover (%)</td>
</tr>
<tr class="odd">
<td align="left"><code>devel_hi</code></td>
<td align="left">High Development Land Cover (%)</td>
</tr>
<tr class="even">
<td align="left"><code>forest</code></td>
<td align="left">Riparian (200 ft Buffer) Forest Cover (%)</td>
</tr>
<tr class="odd">
<td align="left"><code>prcp2</code></td>
<td align="left">2-day Precipitation (mm)</td>
</tr>
<tr class="even">
<td align="left"><code>prcp30</code></td>
<td align="left">30-day Precipitation (mm)</td>
</tr>
</tbody>
</table>
<p>The fixed effects also include the following interaction terms.</p>
<table>
<colgroup>
<col width="36%" />
<col width="63%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Interaction Term</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>prcp2.da</code></td>
<td align="left">2-day Precipitaation x Drainage Area</td>
</tr>
<tr class="even">
<td align="left"><code>prcp30.da</code></td>
<td align="left">30-day Precipitaation x Drainage Area</td>
</tr>
<tr class="odd">
<td align="left"><code>airTemp.da</code></td>
<td align="left">Air Temperature x Total Drainage Area</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp.impoundArea</code></td>
<td align="left">Air Temperature x Impounded Drainage Area</td>
</tr>
<tr class="odd">
<td align="left"><code>airTemp.agriculture</code></td>
<td align="left">Air Temperature x Agricultural Land Cover</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp.forest</code></td>
<td align="left">Air Temperature x Riparian (200 ft Buffer) Forest Cover</td>
</tr>
<tr class="odd">
<td align="left"><code>airTemp.devel_hi</code></td>
<td align="left">Air Temperature x High Development Land Cover</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp.prcp2</code></td>
<td align="left">Air Temperature x 2-day Precipitation</td>
</tr>
<tr class="odd">
<td align="left"><code>airTemp.prcp30</code></td>
<td align="left">Air Temperature x 30-day Precipitation</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp.prcp2.da</code></td>
<td align="left">Air Temperature x 2-day Precipitation x Drainage Area</td>
</tr>
<tr class="odd">
<td align="left"><code>airTemp.prcp30.da</code></td>
<td align="left">Air Temperature x 30-day Precipitation x Drainage Area</td>
</tr>
</tbody>
</table>
</div>
<div id="catchment-random-effects" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Catchment Random Effects<a href="theory.html#catchment-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The random effects for each catchment (<span class="math inline">\(c\)</span>) include the following variables:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intercept</code></td>
<td align="left">Intercept</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp</code></td>
<td align="left">Air Temperature (degC)</td>
</tr>
<tr class="odd">
<td align="left"><code>temp7p</code></td>
<td align="left">7-day Mean Air Temperature (degC)</td>
</tr>
</tbody>
</table>
</div>
<div id="huc-random-effects" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> HUC Random Effects<a href="theory.html#huc-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The random effects for each HUC (<span class="math inline">\(h\)</span>) include the following variables:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intercept</code></td>
<td align="left">Intercept</td>
</tr>
<tr class="even">
<td align="left"><code>airTemp</code></td>
<td align="left">Air Temperature (degC)</td>
</tr>
<tr class="odd">
<td align="left"><code>temp7p</code></td>
<td align="left">7-day Mean Air Temperature (degC)</td>
</tr>
</tbody>
</table>
</div>
<div id="year-random-effects" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Year Random Effects<a href="theory.html#year-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The random effects for each year (<span class="math inline">\(y\)</span>) include the following variables:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intercept</code></td>
<td align="left">Intercept</td>
</tr>
</tbody>
</table>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Letcher2016" class="csl-entry">
Letcher, Benjamin H., Daniel J. Hocking, Kyle O’Neil, Andrew R. Whiteley, Keith H. Nislow, and Matthew J. O’Donnell. 2016. <span>“A Hierarchical Model of Daily Stream Temperature Using Air-Water Temperature Synchronization, Autocorrelation, and Time Lags.”</span> <em>PeerJ</em> 4: e1727. <a href="https://doi.org/10.7717/peerj.1727">https://doi.org/10.7717/peerj.1727</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-sources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["northeast-temp-model.pdf", "northeast-temp-model.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
